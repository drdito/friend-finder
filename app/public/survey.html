<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Survey Page</title>
  <!-- Latest compiled and minified CSS & JS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <script src="https://code.jquery.com/jquery.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
</head>

<body>

  <div class="container">

    <h1>Survey Questions</h1>
    <hr>
    <h2>About You</h2>
    
    <form>
      <div class="form-group">
        <label for="input">Name (Required): </label>
        <input type="input" class="form-control" required="true" id="name">
      </div>
      
      <div class="form-group">
        <label for="input">Link to Photo Image (Required)</label>
        <input type="link" class="form-control" required="true" id="photoLink">
      </div>
      
      <div class="form-group">
        <label for="q1">
          <h3>Question 1</h3>
          <p>Your mind is always buzzing with unexplored ideas and plans.</p>
        </label>
        <select class="form-control" id="q1">
          <option>1 (Strongly Disagree)</option>
          <option>2</option>
          <option>3</option>
          <option>4</option>
          <option>5 (Strongly Agree)</option>
        </select>
      </div>

      <div class="form-group">
        <label for="q2">
          <h3>Question 2</h3>
          <p>Generally speaking, you rely more on your experience than your imagination.</p>
        </label>
        <select class="form-control" id="q2">
          <option>1 (Strongly Disagree)</option>
          <option>2</option>
          <option>3</option>
          <option>4</option>
          <option>5 (Strongly Agree)</option>
        </select>
      </div>

      <div class="form-group">
        <label for="q3">
          <h3>Question 3</h3>
          <p>You find it easy to stay relaxed and focused even when there is some pressure.</p>
        </label>
        <select class="form-control" id="q3">
          <option>1 (Strongly Disagree)</option>
          <option>2</option>
          <option>3</option>
          <option>4</option>
          <option>5 (Strongly Agree)</option>
        </select>
      </div>

      <div class="form-group">
        <label for="q4">
          <h3>Question 4</h3>
          <p>You rarely do something just out of sheer curiosity.</p>
        </label>
        <select class="form-control" id="q4">
          <option>1 (Strongly Disagree)</option>
          <option>2</option>
          <option>3</option>
          <option>4</option>
          <option>5 (Strongly Agree)</option>
        </select>
      </div>

      <div class="form-group">
        <label for="q5">
          <h3>Question 5</h3>
          <p>People can rarely upset you.</p>
        </label>
        <select class="form-control" id="q5">
          <option>1 (Strongly Disagree)</option>
          <option>2</option>
          <option>3</option>
          <option>4</option>
          <option>5 (Strongly Agree)</option>
        </select>
      </div>

      <div class="form-group">
        <label for="q6">
          <h3>Question 6</h3>
          <p>It is often difficult for you to relate to other people’s feelings.</p>
        </label>
        <select class="form-control" id="q6">
          <option>1 (Strongly Disagree)</option>
          <option>2</option>
          <option>3</option>
          <option>4</option>
          <option>5 (Strongly Agree)</option>
        </select>
      </div>

      <div class="form-group">
        <label for="q7">
          <h3>Question 7</h3>
          <p>In a discussion, truth should be more important than people’s sensitivities.</p>
        </label>
        <select class="form-control" id="q7">
          <option>1 (Strongly Disagree)</option>
          <option>2</option>
          <option>3</option>
          <option>4</option>
          <option>5 (Strongly Agree)</option>
        </select>
      </div>

      <div class="form-group">
        <label for="q8">
          <h3>Question 8</h3>
          <p>You rarely get carried away by fantasies and ideas.</p>
        </label>
        <select class="form-control" id="q8">
          <option>1 (Strongly Disagree)</option>
          <option>2</option>
          <option>3</option>
          <option>4</option>
          <option>5 (Strongly Agree)</option>
        </select>
      </div>

      <div class="form-group">
        <label for="q9">
          <h3>Question 9</h3>
          <p>You think that everyone’s views should be respected regardless of whether they are supported by facts or not.</p>
        </label>
        <select class="form-control" id="q9">
          <option>1 (Strongly Disagree)</option>
          <option>2</option>
          <option>3</option>
          <option>4</option>
          <option>5 (Strongly Agree)</option>
        </select>
      </div>

      <div class="form-group">
        <label for="q10">
          <h3>Question 10</h3>
          <p>You feel more energetic after spending time with a group of people.</p>
        </label>
        <select class="form-control" id="q10">
          <option>1 (Strongly Disagree)</option>
          <option>2</option>
          <option>3</option>
          <option>4</option>
          <option>5 (Strongly Agree)</option>
        </select>
      </div>

      <br>
      <button type="submit" class="btn btn-primary btn-lg btn-block" id="submit">Submit</button>

    </form>
    
    <br>
    <footer class="footer">
      <div class="container">
        <p><a href="/api/friends">API Friends Link</a> | <a href="https://github.com/drdito/friend-finder">GitHub Repo</a></p>
      </div>
    </footer>

  </div>

</body>
</html>


<script type="text/javascript">
   
 //Get data of the existing friends
   var friendsData;
   var lowest;
   $.get("api/friends", function(data, status) {
       friendsData = data;
   });

    $("#submit").on("click", function(event) {
      event.preventDefault();
      // Here we grab the form elements
      var scores = [];
      scores.push(parseInt($("#q1").val().charAt(0)));
      scores.push(parseInt($("#q2").val().charAt(0)));
      scores.push(parseInt($("#q3").val().charAt(0)));
      scores.push(parseInt($("#q4").val().charAt(0)));
      scores.push(parseInt($("#q5").val().charAt(0)));
      scores.push(parseInt($("#q6").val().charAt(0)));
      scores.push(parseInt($("#q7").val().charAt(0)));
      scores.push(parseInt($("#q8").val().charAt(0)));
      scores.push(parseInt($("#q9").val().charAt(0)));
      scores.push(parseInt($("#q10").val().charAt(0)));

     var newFriend = {
        "name": $("#name").val().trim(),
        "photo": $("#photoLink").val().trim(),
        "scores": scores
      };



      //console.log(newFriend);

      //Checking for compatibility
      var scoresArray = [];
      for (var i = 0; i < friendsData.length; i++) {
        var diff = 0;
        for (var j = 0; j < newFriend.scores.length; j++) {
          diff += Math.abs(friendsData[i].scores[j] - newFriend.scores[j]);
        }
        scoresArray.push(diff);
      }

      function findLowestIndex(arr) {
        for (var x = 0; x < arr.length; x++) {
          var temp = 1000;
          if (arr[x] < temp) {
            temp = x
          }
        }
        lowest = temp;
        return lowest;
      }



      findLowestIndex(scoresArray);
      console.log(lowest);
      console.log(scoresArray); 
      alert("Best Match is " + friendsData[lowest].name);
     
     /* I have run out of time. I still need a modal to display the information and I realze my logic to grab the lowest score is not squared away. I will continue working*/

      $.ajax({
        type: 'post',
        url: '/api/friends',
        data: JSON.stringify(newFriend),
        contentType: "application/json; charset=utf-8",
        traditional: true,
        success: function (data) {
            }
        });

    });

</script>
